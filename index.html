<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Bidibidi Refugee Settlement</title>
  <meta name="description" content="Bidibidi Refugee Settlement">
  <link rel="stylesheet" type='text/css' media='all' href="css/webslides.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
  <!-- <link rel="stylesheet" type="text/css" media="all" href="css/style_owen.css"> -->
  <!--owens css-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/c3/0.6.14/c3.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://dc-js.github.io/dc.js/css/dc.min.css">
  <link rel="stylesheet" href="css/jqcloud.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
  <link href="https://fonts.googleapis.com/css?family=Alegreya+Sans+SC|Julius+Sans+One|Montserrat|Open+Sans&display=swap" rel="stylesheet">
  <link rel="stylesheet" type="text/css" media="all" href="css/style.css">
  <link rel="shortcut icon" href="img/uganda.ico" type="image/x-icon">
  <style>

  </style>

  <!-- Javascript Library -->
  <script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script src="js/webslides.min.js"></script>
  <script src="js/jqcloud.js"></script>
  <!-- <script src="https://d3js.org/d3.v4.min.js"></script> -->
  </body>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.6.14/c3.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script> -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-ajax/2.1.0/leaflet.ajax.min.js"></script>
  <script type="text/javascript" src="js/chroma.js"></script>
  <script src="https://unpkg.com/leaflet-swoopy"></script>
  <!-- <script src="http://maximeh.github.io/leaflet.bouncemarker/bouncemarker.js"></script> -->
  <script src="https://unpkg.com/d3@5/dist/d3.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/c3/0.6.14/c3.min.js"></script>
  <script src="https://dc-js.github.io/dc.js/js/crossfilter.js"></script>
  <script src="https://dc-js.github.io/dc.js/js/dc.js"></script>
  <script src="js/leaflet-side-by-side.js"></script>
  <!--for the slide on satellite-->
  <script src="js/BubbleLayer.js"></script>

</head>

<body>
  <!-- 1. Movie of Bidi-->
  <article id="webslides">
    <section class="bg-apple">
      <video class="background-video" autoplay muted loop>
        <source src="assets/bidibidi1.mp4" type="video/mp4">
      </video>
      <div class="wrap aligncenter">
        <h1>
          Changing Landscape of Bidibidi Refugee Settlement
        </h1>
      </div>
    </section>
    <!-- 2. Start of the Conflict-->
    <section class="fullscreen">
      <div class="card-50">
        <figure>
          <img src="https://upload.wikimedia.org/wikipedia/commons/5/5d/Generals_of_South_Sudan.jpg" alt="nategeo">
        </figure>
        <div class="flex-content" style="background: white">
          <h2>Conflict in South Sudan</h2>
          <p> The civil war began in 2013, only two years after South Sudan gained independence from Sudan, after President Salva Kiir accused Vice President Riek Machar of planning a coup d’état.
            <br> <br>
            It is not clear if a coup was actually planned, but Machar left the vice presidency and ruling political party, the Sudan People’s Liberation Movement (SPLM), and formed his own party, the Sudan People’s Liberation Movement in Opposition
            (SLPM-IO), challenging Kiir and the SPLM for control of South Sudan. </p>
        </div>
      </div>
    </section>
    <!-- 3. Conflict characterization-->
    <section class="fullscreen">
      <div class="card-50">
        <div class="flex-content" style="background: white">
          <h3>South Sundanese Civil War</h3>
          <p> It has been characterized by its large amounts of child soldiers, high rates of sexual violence, and ethnic cleansing between rival ethnic groups, mainly between the Dinkas and the Nuer, even though both political parties have supporters
            from both groups.
            <br><br>An estimated 400,000 people have been killed and forced another 2.5 million people to flee to other countries. </p>
          <!-- A peace deal was signed in September 2018 between the SPLM and the SPLM-IO and pledged to restore peace and stability, as well as rebuild the livelihoods and homes that were destroyed. The peace deal hasn’t yet been deemed a success however, as South Sudan still has a long way to go in repairing it’s fractured government and military.</p> -->
        </div>
        <figure>
          <img src="https://upload.wikimedia.org/wikipedia/commons/d/d6/SPLA_soldiers_near_Juba_%28April_2016%29_3.jpg" alt="Jason Patinkin ">
        </figure>
    </section>
    <!-- 4. Juba conflict-->
    <section class="fullscreen">
      <div id="mymap"></div>
      <div class="card-50">
        <div class="flex-content" style="background: white">
          <h2>The Juba Clashes</h2>
          <p>After a series of conflicts in July 2016 in Juba between the SPLM and SPLM-IO, migration to Uganda grew expontentially. The conflicts in Juba, the capital of South Sudan, led to extensive looting through out the city and about 300 people
            being killed. <br>The majority of the refugees displaced by the Juba Clashes moved to the northwestern area of Uganada, though some migrated further south.</p>
          <div id="chart"></div>
        </div>
      </div>
    </section>
    <section class="fullscreen">
      <div class="card-50">
        <figure>
          <img src="https://live.staticflickr.com/8095/29494084820_c9d4b7929d_k.jpg" alt="nategeo">
        </figure>
        <div class="flex-content">

          <h1>Bidibidi Refugee Settlement</h1>
          <p> </p>
        </div>
      </div>
    </section>
    <section class="fullscreen">
      <div id="mymap2"></div>
      <div class="card-50 ">
        <div class="flex-content" style="background: white">
          <h1>This is Bidibidi Refugee Settlement <span>
              <img src="img/arrow2.svg" alt="arrow">
            </span></h1>
          <p> Bidibidi was a small village prior to 2016.
            It is now a <a href="https://www.nationalgeographic.com/magazine/2019/04/how-bidibidi-uganda-refugee-camp-became-city/">city</a>
            <br><br> <a href="https://en.wikipedia.org/wiki/Bidi_Bidi_Refugee_Settlement">Bidibidi Refugee Setttlement</a> was considered the largest refugee settlement in 2017.
            <br><br> The landscape drastically changed over the last few years with the influx of migration to the area.

            <br> <br> There are multiple camps in the region.</p>
          <h2>Next two Slides:</h2>
          <p> Satellite Imagery of different areas in the camp.</p>
        </div>
      </div>
    </section>
    <!-- 4. satellite comparison 1-->
    <section class="bg-black slide-top">
      <div class="wrap">
        <div id="mysatellitemap"></div>
        <div class="content-center">
          <h3>Changing Landscape in Bidibidi</h3>
        </div>
        <div class="content-left">
          <h1>2016</h1>
        </div>
        <div class="content-right">
          <h1>2018</h1>
        </div>
      </div>
    </section>
    <!--5. satellite comparison 2-->
    <section class="bg-black slide-top">
      <div class="wrap">
        <div id="mysatellitemap2"></div>
        <div class="content-center">
          <h3>Changing Landscape in Bidibidi</h3>
        </div>
        <div class="content-left">
          <h1>2016</h1>
        </div>
        <div class="content-right">
          <h1>2018</h1>
        </div>
      </div>
    </section>

    <!-- 6. Intro to Icon map-->
    <section class="bg-black">
      <span class="background dark" style="background-image:url('https://live.staticflickr.com/8186/29158772504_f7f9074be7_k.jpg')"></span>
      <div class="wrap">
        <h3><strong>Amenities within the camps of Bidibidi</strong></h3>
        <ul class="flexblock features">
          <li>

              <i class="fas fa-clinic-medical fa-4x"></i>

            <div>
              <h2>
                Health concerns increased as the number of South Sudan refugees entering Uganda continued to increase.
              </h2>

            </div>
          </li>
          <li>
            <div>
              <i class="fas fa-school fa-4x"></i>
            <h2>
              Education :  locations of schools and
            </h2>
            </div>
          </li>
          <li>
            <div>
              <i class="fas fa-place-of-worship fa-4x"></i>
              <h2>
                Churchs : Location of various churches and their faith.
              </h2>
            </div>
          </li>
        </ul>
        <ul class="flexblock features">
          <li>
<img src="img/police1.svg" alt="" style="width:100px;height:90px;">
            <div>

              <h2>
                Law enforcement locations providing safety to the camps.
              </h2>

            </div>
          </li>
          <li>
            <img src="img/community1.svg" alt="" style="width:100px;height:90px;">
            <div>

            <h2>
              Communty centers bring individuals together.
            </h2>
            </div>
          </li>
          <li>
            <div>
<i class="fas fa-money-bill-wave fa-3x"></i>
              <h2>

                Shopping Centers indicating the growing economic hubs for communities.
              </h2>
            </div>
          </li>
        </ul>
      </div>
    </section>
    <section class="fullscreen slide-top">
      <div id="mymap3"></div>
      <div class="content-center">
        <h1>Amenities in Bidibidi</h1>
        <p>Click on Amenities to see their location</p>
      </div>
    </section>
    <section class="fullscreen">
      <div class="card-50">
        <figure>
          <img src="https://live.staticflickr.com/8105/29673871242_e49753869f_k.jpg" alt="nategeo">
        </figure>
        <div class="flex-content">
          <h1> Bidibidi WordCloud  </h1> <h2>Textual Visialization</h2>
          <h3>Revealing a Sense of Place</h3>
        </div>
      </div>
    </section>
    <!-- 7. Wordcloud Map-->
    <section class="fullscreen">
      <div id="mycloud" class="wrap">
        <div class="card-50 bg-white">
          <figure id="cloud"></figure>
          <div class="flex-content">
            <span class="background" style="background-image:url('img/bidi.png')"></span>
            <figure id="chartword"></figure>
            <div id="info2">
              <span class="alignleft"> <a href="https://www.instagram.com/explore/locations/1281867775213393/bidibidi-refugee-settlement-northern-uganda/" title="Instagram">
                  <img class="blacklogo" src="img/instagram.svg" alt="Instagram">
                </a></span>
              <p> <br> <br> </p>
              <h4>Select a year in bar graph : </h4>
              <h6>Hashtags weighted off of their frequency in the year. <br> Y-axis Number of posts in the given year. <br> X-axis: Instagram Post within the Year</h6><br><br>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="fullscreen">
      <div class="card-60">
        <figure>
          <img src="https://scontent-sea1-1.cdninstagram.com/vp/214068bc6b599fb0cc1e956b68ef3265/5D37960C/t51.2885-15/e35/22351698_1157608411038733_1516996205727449088_n.jpg?_nc_ht=scontent-sea1-1.cdninstagram.com" alt="nategeo">
        </figure>
        <div class="flex-content" style="background: white">
          <h3>Thank You for Viewing</h3>
          <p>Currently, the most liked photo on <a href="https://www.instagram.com/p/BaIyhXCDrH-/">Instagram</a> at the geotagged location Bidibidi Refugee Settlement</p><br><br>
          <span>
            <img src="img/arrow.svg" alt="arrow">
          </span>
        </div>
      </div>
    </section>
    <section>
      <div class="wrap">
        <h2>Team Members</h2>
        <ul class="flexblock clients border">
          <li>
            <a href="https://github.com/loweas" title="Ashley Lowe">
              <figure>
                <img src="https://avatars2.githubusercontent.com/u/46502352?s=400&u=a0755d42eaec0f2b33e7dcf2a42d469b55140479&v=4" alt="ashley">
                <figcaption>
                  <h3>Team Lead</h3>
                  <p> OSU Grad Student in Applied Economics</p>
                </figcaption>
              </figure>
            </a>
          </li>
          <li>
            <a href="https://github.com/MarkleyO" title="Owen">
              <figure>
                <img src="" alt="">
                <figcaption>
                  <h3>Owen</h3>
                  <p></p>
                </figcaption>
              </figure>
            </a>
          </li>
          <li>
            <a href="https://github.com/plobrien" title="Paul">
              <figure>
                <img src="https://avatars3.githubusercontent.com/u/46575613?s=460&v=4" alt="">
                <figcaption>
                  <h3>Paul</h3>
                  <p>OSU Undergrad Student in Geography and Geospatial Science</p>
                </figcaption>
              </figure>
            </a>
          </li>
          <li>
            <a href="https://github.com/jakobzhao" title="Bo Zhao">
              <figure>
                <img src="https://avatars3.githubusercontent.com/u/134784?s=400&v=4" alt="Bo">
                <figcaption>
                  <h3>bo Zhao</h3>
                  <p>Prof. Humanistic GIS</p>
                </figcaption>
              </figure>
            </a>
          </li>
        </ul>
      </div>
    </section>
  </article>


  <script>
    var chart, timer;

    var map = L.map("mymap", {
      zoomControl: false,
      scrollWheelZoom: false
    }).setView([2.1894481, 28.8365927], 7);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map);


    L.geoJson.ajax("assets/southanduga.geojson", {

      style: function(feature) {
        switch (feature.properties.ADM0_EN) {
          case 'Uganda':
            return {
              color: "#00FF2A"
            };
        }
      }
    }).addTo(map);

    L.geoJson.ajax("assets/settlements.json", {
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      },
      style: function(feature) {
        switch (feature.properties.name) {
          case 'Bidi Bidi Refugee Settlement':
            return {
              color: "#FF00F6"
            };
        }
      }
    }).addTo(map);





    var conflict = L.icon({
      iconUrl: 'img/conflict.svg',
      iconSize: [25, 30], // size of the icon
    });


    L.marker([4.85, 31.6], {
      icon: conflict
    }).addTo(map);

    var map2 = L.map("mymap2", {
      zoomControl: false,
      scrollWheelZoom: false
    }).setView([3.3894481, 28.8365927], 7);

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map2);
    L.geoJson.ajax("assets/southanduga.geojson", {
      onEachFeature: function(feature, layer) {

      },
      style: function(feature) {
        switch (feature.properties.ADM0_EN) {
          case 'Uganda':
            return {
              color: "#00FF2A"
            };
        }
      }
    }).addTo(map2);
    L.geoJson.ajax("assets/settlements.json", {
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      },
      style: function(feature) {
        switch (feature.properties.name) {
          case 'Bidi Bidi Refugee Settlement':
            return {
              color: "#FF00F6"
            };
        }
      }
    }).addTo(map2);
    L.geoJson.ajax("assets/camps.geojson", {
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          permanent: true,
          className: "feature-tooltip"
        });
      },
      style: function(feature) {
        return {
          color: "#d8d815"
        }

      }
    }).addTo(map2);




    var map3 = L.map("mymap3", {
      zoomControl: false,
      scrollWheelZoom: false
    }).setView([3.3963093129, 31.3759739178], 11);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    }).addTo(map3);
    L.geoJson.ajax("assets/southanduga.geojson", {

      style: function(feature) {
        switch (feature.properties.ADM0_EN) {
          case 'Uganda':
            return {
              color: "#00FF2A"
            };
        }
      }
    }).addTo(map3);
    L.geoJson.ajax("assets/camps.geojson", {
      onEachFeature: function(feature, layer) {
        layer.bindPopup(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      },
      style: function(feature) {
        return {
          color: "#d8d815"
        }

      }
    }).addTo(map3);

    L.geoJson.ajax("assets/settlements.json", {
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      },
      style: function(feature) {
        switch (feature.properties.name) {
          case 'Bidi Bidi Refugee Settlement':
            return {
              color: "#FF00F6"
            };
        }
      }
    }).addTo(map3);


    var colors = chroma.scale('Dark2').mode('lch').colors(10);
    for (i = 1; i < 11; i++) {
      $('html > head').append($("<style> .marker-icon-" + i.toString() + " { color: " + colors[i] + "; font-size: 15px; text-shadow: 0 0 3px #ffffff;} </style>"));
    }


    var health = L.geoJson.ajax('assets/health.geojson', {
      pointToLayer: function(feature, latlng) {
        return L.marker(latlng, {
          icon: L.divIcon({
            html: '<i class="fas fa-clinic-medical"></i>',
            className: 'marker-icon-5'
          })
        });
      },
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      }
    });


    var education = L.geoJson.ajax('assets/education.geojson', {
      pointToLayer: function(feature, latlng) {
        return L.marker(latlng, {
          icon: L.divIcon({
            html: '<i class="fas fa-school"></i>',
            className: 'marker-icon-2'
          })
        });
      },
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      }
    });
    var police = L.geoJson.ajax('assets/policecommunity.geojson', {
      pointToLayer: function(feature, latlng) {
        if (feature.properties.amenity == "police") {
          return L.marker(latlng, {
            icon: L.divIcon({
              html: '<img src="img/police.svg" alt="" style="width:30px;height:20px;">',
              className: 'marker-icon-2'
            })
          });
        } else {
          return L.marker(latlng, {
            icon: L.divIcon({
              html: '<img src="img/community.svg" alt="" style="width:40px;height:30px;">',
              className: 'marker-icon-2'
            })
          });
        }
      },
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      }
    });

    var mobile = L.geoJson.ajax('assets/shops.geojson', {
      pointToLayer: function(feature, latlng) {
        return L.marker(latlng, {
          icon: L.divIcon({
            html: '<i class="fas fa-money-bill-wave"></i>',
            className: 'marker-icon-1'
          })
        });
      },
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.name, {
          sticky: true,
          className: "feature-tooltip"
        });
      }
    });

    var worship = L.geoJson.ajax('assets/placesofworship.geojson', {
      pointToLayer: function(feature, latlng) {
        return L.marker(latlng, {
          icon: L.divIcon({
            html: '<i class="fas fa-place-of-worship"></i>',
            className: 'marker-icon-3'
          })
        });
      },
      onEachFeature: function(feature, layer) {
        layer.bindTooltip(feature.properties.religion, {
          sticky: true,
          className: "feature-tooltip"
        });
      }
    });


    var overlays = {
      "Health Centers": health,
      "Schools": education,
      "Police and Community Centers": police,
      "Shops": mobile,
      "Places of Worship": worship,
    };

    var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}');
    var CartoDB_PositronNoLabels = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
      subdomains: 'abcd',
      maxZoom: 19
    });

    var baseMaps = {
      'Grey Scale': map3,
      'No Labels': CartoDB_PositronNoLabels,
      'Satellite': satellite

    };


    L.control.layers(baseMaps, overlays, {
      collapsed: false
    }).addTo(map3);




    Promise.all([
      d3.csv('assets/pop.csv')
    ]).then(function(data) {
      var t = ["t"];
      var Migrate_Population = ["Migrate_Population"];

      data[0].forEach(function(d) {
        t.push(new Date(d["t"]));
        Migrate_Population.push(+d["Migrate_Population"]);
      });

      chart = c3.generate({
        bindto: "#chart",
        title: {
          text: 'Migration from South Sudan'
        },
        data: {
          x: 't',
          columns: [t, Migrate_Population],
          type: 'spline',
        },
        axis: {
          x: {
            type: 'timeseries',
            tick: {
              format: '%Y'
            }
          },
          y: {
            label: {
              text: '# of Yearly Migration',
              position: 'outer-middle'
            }
          },
        },
        grid: {
          x: {
            lines: [{
              value: "2016-06-30",
              text: 'Volience in Juba'
            }]
          },
        },
        point: {
          r: 0,
          focus: {
            expand: {
              r: 2
            }
          }
        },
        stanford: {
          scaleMin: 1,
          scaleMax: 10000,
          scaleFormat: 'pow10',
          padding: {
            top: 15,
            right: 0,
            bottom: 0,
            left: 0
          }

        },
      });
    });

    //start code for satellite imagery
    var satelliteMap = L.map("mysatellitemap", {
      zoomControl: false,
      scrollWheelZoom: false
    }).setView([3.5199, 31.3300], 16);

    var satelliteMap2 = L.map("mysatellitemap2", {
      zoomControl: false,
      scrollWheelZoom: false
    }).setView([3.4667, 31.3743], 15);

    var presentTile = L.tileLayer('https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      maxZoom: 19
    });
    var presentTile2 = L.tileLayer('https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      maxZoom: 19
    });
    var pastTile = L.tileLayer('https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/WMTS/1.0.0/default028mm/MapServer/tile/29387/{z}/{y}/{x}', {
      maxZoom: 19
    });
    var pastTile2 = L.tileLayer('https://wayback.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/WMTS/1.0.0/default028mm/MapServer/tile/29387/{z}/{y}/{x}', {
      maxZoom: 19
    });
    pastTile.addTo(satelliteMap);
    pastTile2.addTo(satelliteMap2);
    presentTile.addTo(satelliteMap);
    presentTile2.addTo(satelliteMap2);

    L.control.sideBySide(pastTile, presentTile).addTo(satelliteMap);
    L.control.sideBySide(pastTile2, presentTile2).addTo(satelliteMap2);
    //end code for satellite imagery


    function wordFrequency(txt, freq) {

      var wordArray = txt.split(/[ .?!,*'"”“]/);
      //var wordArray = txt.split(" ");
      var newArray = [],
        filteredArray = [],
        wordObj;
      wordArray.forEach(function(word) {
        wordObj = newArray.filter(function(w) {
          return w.text === word.toLowerCase();
        });
        if (wordObj.length) {
          wordObj[0].weight += 1;
        } else {
          newArray.push({
            text: word,
            weight: 1
          });
        }
      });

      var words = ["[]", ",", "[", "]", "", "][", "][][", "][][][", "][][][]["];

      newArray.filter(function(word) {
        if (!words.includes(word.text) && word.weight > freq) {
          filteredArray.push(word);
        }
      });

      return filteredArray;

    }


    colorscheme = chroma.scale('Dark2').colors(10).reverse();
    d3.csv('assets/locationbidiall.csv').then(function(data) {


      var filter = crossfilter(data);

      var all = filter.groupAll();

      var everything = filter.dimension(function(d) {
        return d
      });


      var dateDimension = filter.dimension(function(d) {

        return d.Year;
      });
      var dateDimensionGroup = dateDimension.group();


      var dateChart = dc.barChart('#chartword');
      dateChart
        .dimension(dateDimension)
        .group(dateDimensionGroup)
        .elasticY(true)
        .x(d3.scaleOrdinal()) //
        .xUnits(dc.units.ordinal)
        .yAxis()
        .ticks(3); //timeDate object that has the format for the date

      dc.renderAll();

      var texts = "";
      everything.top(Infinity).filter(function(d) {
        return texts += (" " + d.tags);
      });

      var frequencyList = null;
      frequencyList = wordFrequency(texts, 6);

      $("#cloud").jQCloud(frequencyList, {
        colors: colorscheme,
        autoResize: true,
        delay: 5,
        shape: 'rectangular',
        fontSize: {
          from: 0.1,
          to: 0.02
        }
      });



      dateChart.on('filtered', function(chartword, filter) {

        var texts = "";
        everything.top(Infinity).filter(function(d) {
          return texts += (" " + d.tags);
        });

        frequencyList = wordFrequency(texts, 4);
        $('#cloud').jQCloud('destroy');
        $("#cloud").jQCloud(frequencyList, {
          colors: colorscheme,
          autoResize: true,
          // steps: 20,
          delay: 5,
          shape: 'rectangular',
          fontSize: {
            from: 0.1,
            to: 0.02
          }
        });
        dc.renderAll();
      });
    });




    ws = new WebSlides();
    ws.el.addEventListener('ws:slide-change', function() {

      crtDiv = $(".current div");
      //Map 1 'flyto' animation location and function
      if (crtDiv.attr("id") === "mymap") {

        timer = setInterval(function() {}, 100);
        clearInterval(timer);

        $.getJSON("assets/migration.geojson", function(migration) {


          for (let i = 0; i < migration.features.length; i++) {


            timer = setInterval(function() {


              L.swoopyArrow([4.85, 31.6], [migration.features[i].geometry.coordinates[1], migration.features[i].geometry.coordinates[0]], {
                labelFontSize: 12,
                iconAnchor: [20, 10],
                iconSize: [30, 16],
                color: '#FF00F6',
                opacity: 0.7,
                weight: '2'
              }).addTo(map);



            }, 200);



            // setTimeout(function() {
            //   lng = migration.features[i].geometry.coordinates[0];
            //   lat = migration.features[i].geometry.coordinates[1];
            //
            //   L.swoopyArrow([4.85, 31.6], [lat, lng], {
            //     labelFontSize: 12,
            //     iconAnchor: [20, 10],
            //     iconSize: [30, 16],
            //     color: '#FF00F6',
            //     opacity: 0.7,
            //     weight: '2'
            //   }).addTo(map);
            //   // layergroup2.addLayer( L.marker([lat, lng], {icon: pwbIcon}));
            //
            // }, 400 * i);






          }


        });


        chart.resize();




      } else if (crtDiv.attr("id") === "mymap2") {
        map2.invalidateSize();
        //Fly to a new location.
        map2.flyTo([3.3963093129, 31.1759739178], 11, {
          animate: true,
          duration: 4
        });

      } else if (crtDiv.attr("id") === "mypop") {

        //new slide adjust for satellite 1 and 2
      } else if (crtDiv.attr("id") === "mysatellitemap") {
        satelliteMap.invalidateSize();
        satelliteMap.fitBounds([
          [3.5288, 31.3403],
          [3.5137, 31.3130]
        ]);
      } else if (crtDiv.attr("id") === "mycloud") {
        dc.renderAll();



      }








    });
  </script>
</body>

</html>
